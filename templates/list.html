<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <!-- Google tag (gtag.js) --> <script async src="https://www.googletagmanager.com/gtag/js?id=G-9FR7K2YVNR"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-9FR7K2YVNR'); </script>
    <title>List</title>
    <link rel="icon" href="/src/image/favicon.ico" type="image/x-icon"/>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="/src/css/bootstrap.css" rel='stylesheet' type='text/css' />
    <link href="/src/css/style.css" rel='stylesheet' type='text/css' />
    <link href="/src/css/all.min.css" rel="stylesheet" type="text/css" />

    <script src="/src/js/jquery.min.js"></script>
    <script src="/src/js/bootstrap.js"></script>
</head>

<body>
    <div class="container-fluid" style="min-height: 100vh; background-color: #cedfe6">
        <div class="navigation" style="background-image: linear-gradient(to bottom, #054863, #0d3245); padding-bottom: 2%; padding-top: 2%;">
            <div class="logo" style="margin-left: 8%;">
                <!--h1><span>G</span>eneticFlow</h1-->
                <a href="/"><img src="/src/image/logo-index.jpg" width="324" height="72"></a>
            </div>
            <div class="clearfix"></div>
        </div>
        <div class="banner-info" style="margin-left: 8%;">
            <div style="float: left; width: 95%;">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Sequence</th>
                            <th>Scholar Name</th>
                            <th id="paper-count" class="asc"></th>
                            <th id="citations"></th>
                            <th id="h-index"></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>

                    </tbody>
                </table>
            </div>
        </div>
        <div class="clearfix"></div>
    </div>

    <script>
        // $("#scholars").DataTable({
        //     "order": [[1, 'desc']], // 默认按第一列升序排序
        //     "columnDefs": [
        //         { "orderable": false, "targets": [4] } // 第一列不可排序
        //     ]
        // });
        function table_show(scholarList, fieldType) {
            $('table tbody').empty();
            for (let i = 0; i < scholarList.length; i++) {
                let scholar = scholarList[i];
                scholar["rank"] = i+1;
                var content = `
                    <tr>
                        <td>${scholar["rank"]}</td>
                        <td>${scholar["name"]}</td>
                        <td>${scholar["paperCount"]}</td>
                        <td>${scholar["citationCount"]}</td>
                        <td>${scholar["hIndex"]}</td>
                        <td>
                            <a class="btn-sm btn-primary" href="/index?field=${fieldType}&id=${scholar["authorRank"]}" style="font-size: 12px; text-decoration: none;">
                                Visualize
                            </a>
                        </td>
                    </tr>`;

                $('table tbody').append(content);
            }
        }
        function compare(index, sortType) {
            return function(row1, row2) {
                var aValue = row1[index];
                    bValue = row2[index];
                if (index == "name") {
                    if (sortType == 'asc') return aValue > bValue ? 1 : aValue < bValue ? -1 : 0;
                    else return aValue > bValue ? -1 : aValue < bValue ? 1 : 0;
                }
                else {
                    aValue = parseInt(aValue);
                    bValue = parseInt(bValue);
                    return sortType == 'desc' ? aValue - bValue : bValue - aValue;
                }
            }
        }
        $(function () {
            var scholarList = {{ scholarList|safe }},
                fieldType = "{{ field }}",
                field, question_content;
            if (fieldType == "visualization") {
                field = "Visualization";
                question_content = "The scholar metrics below are obtained from all the publications tagged as visualization papers in Microsoft Academic Graph (MAG) dataset, till 2020.5. All paper citation counts are native data from MAG.";
            }
            else if (fieldType == "acl") {
                field = "NLP";
                question_content = "The scholar metrics below are obtained from all the paper publications in ACL Anthology Reference Corpus (ARC), till 2021.7. All paper citation counts are native data from ARC.";
            }
            var content = `
            <div class="question">
                <i class="fa-solid fa-circle-question hover-text"></i>
                <span class="question-tip" style="font-size: 2px;">
                    ${question_content}
                </span>
            </div>`;
            $("#paper-count").text(field + " Paper Count ");
            $("#citations").text(field + " Paper Citations ");
            $("#h-index").text("h-index (" + field + ") ");
            $("#paper-count, #citations, #h-index").append(content);
            table_show(scholarList, fieldType);
        });
        $('table').on('click', 'th', function () {
            var index = $(this).index();
            if (index != 0) {
                const indexLabel = ["unamed", "name", "paperCount", "citationCount", "hIndex"];
                var thClass = $(this).hasClass('asc') ? 'desc' : 'asc',
                    scholarList = {{ scholarList|safe }},
                    fieldType = "{{ field }}";
                scholarList.sort(compare(indexLabel[index], thClass));

                $('table th').removeClass('asc desc');
                $(this).addClass(thClass);
                table_show(scholarList, fieldType);
            }
        });
    </script>
</body>
</html>